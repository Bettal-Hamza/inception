# 403 Forbidden Error - Quick Fix

## The Problem:
WordPress files weren't being downloaded, so NGINX had no index.php to serve.

## The Fix Applied:
1. **WordPress entrypoint now downloads WordPress core** with `wp core download`
2. **Added required PHP extensions** for WordPress to work properly
3. **Better check for WordPress installation** using `wp core is-installed`

## On Your Virtual Machine - Apply The Fix:

```bash
# 1. Stop all containers
make down

# 2. Clean old data (this will remove the empty WordPress directory)
make fclean

# 3. Rebuild with the fixes
make

# 4. Watch the logs to see WordPress downloading and installing
docker-compose -f srcs/docker-compose.yml logs -f wordpress
```

### What You Should See in the Logs:
```
wordpress_1  | Waiting for database wordpress...
wordpress_1  | Downloading WordPress...
wordpress_1  | Success: WordPress downloaded.
wordpress_1  | Creating wp-config.php...
wordpress_1  | Success: Generated 'wp-config.php' file.
wordpress_1  | Installing WordPress...
wordpress_1  | Success: WordPress installed successfully.
wordpress_1  | Creating additional WordPress user...
wordpress_1  | Success: Created user 'hbettal_user'.
```

## Quick Verification:

```bash
# 1. Check WordPress files exist
docker exec $(docker ps -qf "name=wordpress") ls -la /var/www/html/

# You should see:
# index.php
# wp-config.php
# wp-content/
# wp-admin/
# wp-includes/
# etc.

# 2. Check file permissions
docker exec $(docker ps -qf "name=wordpress") ls -l /var/www/html/index.php

# 3. Test the site
curl -k https://hbettal.42.fr
```

## If Still Getting 403:

### Check permissions in the container:
```bash
docker exec $(docker ps -qf "name=wordpress") chmod -R 755 /var/www/html
docker exec $(docker ps -qf "name=wordpress") chown -R nobody:nobody /var/www/html
```

### Verify NGINX can read the files:
```bash
docker exec $(docker ps -qf "name=nginx") ls -la /var/www/html/
docker exec $(docker ps -qf "name=nginx") cat /var/www/html/index.php | head -5
```

## Expected Result:
✅ Open `https://hbettal.42.fr` in browser
✅ See WordPress site or installation screen
✅ Login at `https://hbettal.42.fr/wp-admin`

## Full Clean Rebuild (if needed):
```bash
# Nuclear option - start completely fresh
docker-compose -f srcs/docker-compose.yml down -v
docker system prune -af --volumes
sudo rm -rf /home/hbettal/data/wordpress/*
sudo rm -rf /home/hbettal/data/mariadb/*
make
```
